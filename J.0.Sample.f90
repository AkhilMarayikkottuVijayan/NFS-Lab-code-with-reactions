SUBROUTINE SAMPLE
USE VARIABLES
INTEGER :: MC,MSC,Q,L,N
DOUBLE PRECISION :: RATIO
IF(NPR.EQ.NTS(1))THEN
	DO 101 L=1,NSP_T
		DO 102 N=1,NC_MAX !NC_D
		CS(1,N,L)=1.E-6
			DO 103 Q=2,12
				CS(Q,N,L)=0.0d0
			103	CONTINUE
		102	CONTINUE
	101 CONTINUE
	NSMP =0
END IF
!IF((NPR.LT.NTS(1)).AND. MOD(NPR,500).EQ.1)THEN
!	DO 104 L=1,NSP_T
!		DO 105 N=1,NC_MAX !NC_D
!		CS(1,N,L)=1.E-6
!			DO 106 Q=2,12
!				CS(Q,N,L)=0.0d0
!		106	CONTINUE
!		105	CONTINUE
!	104 CONTINUE
!	NSMP =0
!END IF




NSMP = NSMP+1
	DO 100 I=1,NM
		L = PP(9,I)
		MSC = IP(I)
		MC = ISC(MSC) 				
		CS(1,MC,L)=CS(1,MC,L)+1 
		DO 110 LL=1,3
			CS(LL+1,MC,L)=CS(LL+1,MC,L)+PP(LL+3,I) 			
			CS(LL+4,MC,L)=CS(LL+4,MC,L)+PP(LL+3,I)**2 			
110		CONTINUE
		IF(SP(7,L).GT.0)CS(8,MC,L)=CS(8,MC,L)+PP(7,I)
		IF(SP(8,L).GT.0)THEN
			CS(9,MC,L)=CS(9,MC,L)+INT(PP(10,I))*BOLTZ*SP(9,L)
 			IF (INT(PP(10,I)).EQ.0) CS(10,MC,L)=CS(10,MC,L)+1.
 			IF (INT(PP(10,I)).EQ.1) CS(11,MC,L)=CS(11,MC,L)+1.
		END IF
		CS(12,MC,L)= CS(12,MC,L) + PP(8,I)
		
		!IF(rank.eq.0) WRITE(*,*)PP(8,I)
100 CONTINUE


	RETURN
END SUBROUTINE
